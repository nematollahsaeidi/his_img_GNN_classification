# Histopathology Image Segmentation and Classification

## Description
This repository contains a deep learning pipeline for classifying histopathology images into benign and malignant categories. The model uses multiple pre-trained architectures (VGG19, EfficientNet-B0, DenseNet201, and ViT) and performs training with K-Fold cross-validation. The implementation utilizes PyTorch and Torchvision for model training and evaluation.

## Dataset
The dataset is constructed based on the **PanNuke dataset**, containing two categories: malignant and benign. The dataset is generated by extracting relevant images and masks from PanNuke, selecting malignant cases based on the proportion of neoplastic cells, and categorizing the remaining cases as benign.

The dataset consists of benign and malignant histopathology images stored as NumPy arrays. These images are loaded and preprocessed before being used for training and evaluation.

- **Benign Images:** `benign_images.npy`
- **Benign Labels:** `benign_labels.npy`
- **Malignant Images:** `malignant_images.npy`
- **Malignant Labels:** `malignant_labels.npy`

The labels are encoded using `LabelEncoder` to convert categorical values into numerical form.

## Dataset Generation
To generate the dataset, run the following script:
```sh
python pannuke_binary_data_generation.py
```
This will:
- Load the PanNuke dataset.
- Extract malignant and benign images based on neoplastic cell proportions.
- Save the generated dataset as NumPy arrays for further training and evaluation.

## Model Architectures
The script supports the following deep learning models:
- **VGG19**
- **EfficientNet-B0**
- **DenseNet201**
- **Vision Transformer (ViT-B/16)**

Each model is initialized with pre-trained weights and modified to classify the given dataset.

## Training Strategy
- The dataset is split into **train/validation (80%)** and **test (20%)**.
- Training is performed using **5-Fold Cross-Validation**.

## Performance Metrics
- **Accuracy**
- **F1-Score (Macro Average)**

The results are aggregated across 5 folds, and the mean and standard deviation of accuracy and F1-score are reported.

## Running the Script
To train and evaluate the models, simply run the script:
```sh
python base_models_classification.py
```

